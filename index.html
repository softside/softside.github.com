<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="a.css" type="text/css" rel="stylesheet" charset="utf-8" />
        <link href="styles/dark.css" type="text/css" rel="stylesheet" charset="utf-8" />
        <title>softside@smth</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <script type="text/javascript" src="underscore-min.js"></script>
        <script type="text/javascript" src="showdown.js"></script>
        <script src="highlight.pack.js"></script>
        <script type="text/javascript">
            function getParameter(name){ 
                var search = document.location.search;
                var pattern = new RegExp("[?&]"+name+"\=([^&]+)", "g");
                var matcher = pattern.exec(search);
                var items = null;
                if(null != matcher){
                    items = decodeURIComponent(matcher[1]);
                }
                return items;
            }

            function render_list(datas){
                var template = _.template($("#post_list_template").html());
                html=template(datas);
                $("#list_container").html(html);
            }

            function show_post(name){
                $("#list_container").html("");
                $("#list_container").hide();
                $("#loading").show();
                $.get(
                        "blogs/"+name,
                        function(data){
                            var converter = new Showdown.converter();
                            var html = converter.makeHtml(data);
                            $("#post-text").html(html);
                            $("#post-content").show();
                            $("#loading").hide();
                            hljs.tabReplace = '    ';
                            hljs.initHighlighting();
                        }
                );
            }

            function show_index(){
                $("#loading").show();
                $("#post-text").html("");
                $("#post-content").hide();
                $.getJSON(
                        "list.json",
                        function(data){
                            $("#loading").hide();
                            $("#list_container").show();
                            render_list(data);
                        }
                    );
            }

            $(function(){
                $("#show_home").hide();
                $("#header").mousemove(function(){$("#show_home").show()}).mouseout(function(){$("#show_home").hide()});
                var params=getParameter("p");
                if(_.isNull(params)){
                    show_index();
                }else{
                    show_post(params);
                }
             }
            );
        </script>
    </head>
    <body>
        <div class="header">
	</div>
        <div class="content">
            <div id="side" class="fl side">
                <!--your header image can put here or any thing you wish//-->
                <div class="fl mt40 disp">
		  非专业python程序员<br>
		  每天被产品经理各种虐
                </div>
            </div>
            <div id="posts" class="posts ml200">
                <div id="loading" class="loading" style="display:none;"> <img src="images/loading.gif"/> </div>
                <div class="wrapper" id="list_container">
                </div>
                <div id="post-content" class="text">
                    <div id="post-text"></div>
                </div>
            </div>
        </div>
    </body>
    <script id="post_list_template" type="text/template">
        <%_.EACH(DATA,FUNCTION(POST){%>
        <DL>
           <DT CLASS="H20">
           <SPAN CLASS="FL"> <A HREF="INDEX.HTML?P=<%=POST.NAME%>"><%=POST.TITLE%></A></SPAN><SPAN CLASS="FR TIMESTAMP MT10"><%=post.date%></span>
               <span class="slear"></span>
           </dt>
       </dl>
       <%});%>
    </script>
</html>
